var signal=function(){"use strict";var u=ie(function(t,s,a,h){return new(a=a||Promise)(function(r,e){function i(t){try{o(h.next(t))}catch(t){e(t)}}function n(t){try{o(h.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?r(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,n)}o((h=h.apply(t,s||[])).next())})});var e=setTimeout;function h(t){return Boolean(t&&void 0!==t.length)}function i(){}function o(t){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function n(r,i){for(;3===r._state;)r=r._value;0!==r._state?(r._handled=!0,o._immediateFn(function(){var t,e=1===r._state?i.onFulfilled:i.onRejected;if(null!==e){try{t=e(r._value)}catch(t){return void a(i.promise,t)}s(i.promise,t)}else(1===r._state?s:a)(i.promise,r._value)})):r._deferreds.push(i)}function s(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if(t instanceof o)return e._state=3,e._value=t,void c(e);if("function"==typeof r)return void d((i=r,n=t,function(){i.apply(n,arguments)}),e)}e._state=1,e._value=t,c(e)}catch(t){a(e,t)}var i,n}function a(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&o._immediateFn(function(){t._handled||o._unhandledRejectionFn(t._value)});for(var e=0,r=t._deferreds.length;e<r;e++)n(t,t._deferreds[e]);t._deferreds=null}function l(t,e,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=r}function d(t,e){var r=!1;try{t(function(t){r||(r=!0,s(e,t))},function(t){r||(r=!0,a(e,t))})}catch(t){if(r)return;r=!0,a(e,t)}}o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var r=new this.constructor(i);return n(this,new l(t,e,r)),r},o.prototype.finally=function(e){var r=this.constructor;return this.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){return r.reject(t)})})},o.all=function(e){return new o(function(n,o){if(!h(e))return o(new TypeError("Promise.all accepts an array"));var s=Array.prototype.slice.call(e);if(0===s.length)return n([]);var a=s.length;for(var t=0;t<s.length;t++)!function e(r,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var i=t.then;if("function"==typeof i)return void i.call(t,function(t){e(r,t)},o)}s[r]=t,0==--a&&n(s)}catch(t){o(t)}}(t,s[t])})},o.allSettled=function(r){return new this(function(n,t){if(!r||void 0===r.length)return t(new TypeError(typeof r+" "+r+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var o=Array.prototype.slice.call(r);if(0===o.length)return n([]);var s=o.length;for(var e=0;e<o.length;e++)!function e(r,t){if(t&&("object"==typeof t||"function"==typeof t)){var i=t.then;if("function"==typeof i)return void i.call(t,function(t){e(r,t)},function(t){o[r]={status:"rejected",reason:t},0==--s&&n(o)})}o[r]={status:"fulfilled",value:t},0==--s&&n(o)}(e,o[e])})},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o(function(t){t(e)})},o.reject=function(r){return new o(function(t,e){e(r)})},o.race=function(n){return new o(function(t,e){if(!h(n))return e(new TypeError("Promise.race accepts an array"));for(var r=0,i=n.length;r<i;r++)o.resolve(n[r]).then(t,e)})},o._immediateFn="function"==typeof setImmediate?function(t){setImmediate(t)}:function(t){e(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var f=o,p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var y=function(){return(y=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function r(t,e,r,i){var n,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;0<=a;a--)(n=t[a])&&(s=(o<3?n(s):3<o?n(e,r,s):n(e,r))||s);return 3<o&&s&&Object.defineProperty(e,r,s),s}function m(r,i){var n,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(r,a)}catch(t){e=[6,t],o=0}finally{n=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var _="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function v(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function w(t){var e={exports:{}};return t(e,e.exports),e.exports}var g=v(w(function(t,e){var r;r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:_,t.exports=function(t){var x,I=t&&t.Promise||r.Promise,E=t&&t.XMLHttpRequest||r.XMLHttpRequest;return x=Object.create(r,{fetch:{value:void 0,writable:!0}}),function(a){var e,r,h=void 0!==x&&x||"undefined"!=typeof self&&self||void 0!==h&&h,i="URLSearchParams"in h,n="Symbol"in h&&"iterator"in Symbol,u="FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch(t){return!1}}(),o="FormData"in h,c="ArrayBuffer"in h;function s(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function l(t){return t="string"!=typeof t?String(t):t}function t(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach(function(t,e){this.append(e,t)},this):Array.isArray(e)?e.forEach(function(t){this.append(t[0],t[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function f(t){if(t.bodyUsed)return I.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(r){return new I(function(t,e){r.onload=function(){t(r.result)},r.onerror=function(){e(r.error)}})}function y(t){var e=new FileReader,r=p(e);return e.readAsArrayBuffer(t),r}function m(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function _(){return this.bodyUsed=!1,this._initBody=function(t){var e;this.bodyUsed=this.bodyUsed,(this._bodyInit=t)?"string"==typeof t?this._bodyText=t:u&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:o&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:i&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():c&&u&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=m(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c&&(ArrayBuffer.prototype.isPrototypeOf(t)||r(t))?this._bodyArrayBuffer=m(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},u&&(this.blob=function(){var t=f(this);if(t)return t;if(this._bodyBlob)return I.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return I.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return I.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=f(this);return t?t:ArrayBuffer.isView(this._bodyArrayBuffer)?I.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):I.resolve(this._bodyArrayBuffer)}return this.blob().then(y)}),this.text=function(){var t,e,r=f(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,r=p(e),e.readAsText(t),r;if(this._bodyArrayBuffer)return I.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),i=0;i<e.length;i++)r[i]=String.fromCharCode(e[i]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return I.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}c&&(e=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=ArrayBuffer.isView||function(t){return t&&-1<e.indexOf(Object.prototype.toString.call(t))}),d.prototype.append=function(t,e){t=s(t),e=l(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},d.prototype.delete=function(t){delete this.map[s(t)]},d.prototype.get=function(t){return t=s(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(s(t))},d.prototype.set=function(t,e){this.map[s(t)]=l(e)},d.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},d.prototype.keys=function(){var r=[];return this.forEach(function(t,e){r.push(e)}),t(r)},d.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),t(e)},d.prototype.entries=function(){var r=[];return this.forEach(function(t,e){r.push([e,t])}),t(r)},n&&(d.prototype[Symbol.iterator]=d.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function w(t,e){if(!(this instanceof w))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r,i=(e=e||{}).body;if(t instanceof w){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new d(e.headers)),this.method=(r=e.method||this.method||"GET",t=r.toUpperCase(),-1<v.indexOf(t)?t:r),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i),"GET"!==this.method&&"HEAD"!==this.method||"no-store"!==e.cache&&"no-cache"!==e.cache||((e=/([?&])_=[^&]*/).test(this.url)?this.url=this.url.replace(e,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime())}function g(t){var r=new FormData;return t.trim().split("&").forEach(function(t){var e;t&&(t=(e=t.split("=")).shift().replace(/\+/g," "),e=e.join("=").replace(/\+/g," "),r.append(decodeURIComponent(t),decodeURIComponent(e)))}),r}function b(t,e){if(!(this instanceof b))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{},this.type="default",this.status=void 0===e.status?200:e.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in e?e.statusText:"",this.headers=new d(e.headers),this.url=e.url||"",this._initBody(t)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},_.call(w.prototype),_.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},b.error=function(){var t=new b(null,{status:0,statusText:""});return t.type="error",t};var A=[301,302,303,307,308];b.redirect=function(t,e){if(-1===A.indexOf(e))throw new RangeError("Invalid status code");return new b(null,{status:e,headers:{location:t}})},a.DOMException=h.DOMException;try{new a.DOMException}catch(t){a.DOMException=function(t,e){this.message=t,this.name=e;t=Error(t);this.stack=t.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function C(i,s){return new I(function(n,t){var e=new w(i,s);if(e.signal&&e.signal.aborted)return t(new a.DOMException("Aborted","AbortError"));var o=new E;function r(){o.abort()}o.onload=function(){var t,r,e={status:o.status,statusText:o.statusText,headers:(t=o.getAllResponseHeaders()||"",r=new d,t.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t}).forEach(function(t){var e=t.split(":"),t=e.shift().trim();t&&(e=e.join(":").trim(),r.append(t,e))}),r)};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var i="response"in o?o.response:o.responseText;setTimeout(function(){n(new b(i,e))},0)},o.onerror=function(){setTimeout(function(){t(new TypeError("Network request failed"))},0)},o.ontimeout=function(){setTimeout(function(){t(new TypeError("Network request failed"))},0)},o.onabort=function(){setTimeout(function(){t(new a.DOMException("Aborted","AbortError"))},0)},o.open(e.method,function(e){try{return""===e&&h.location.href?h.location.href:e}catch(t){return e}}(e.url),!0),"include"===e.credentials?o.withCredentials=!0:"omit"===e.credentials&&(o.withCredentials=!1),"responseType"in o&&(u?o.responseType="blob":c&&e.headers.get("Content-Type")&&-1!==e.headers.get("Content-Type").indexOf("application/octet-stream")&&(o.responseType="arraybuffer")),!s||"object"!=typeof s.headers||s.headers instanceof d?e.headers.forEach(function(t,e){o.setRequestHeader(e,t)}):Object.getOwnPropertyNames(s.headers).forEach(function(t){o.setRequestHeader(t,l(s.headers[t]))}),e.signal&&(e.signal.addEventListener("abort",r),o.onreadystatechange=function(){4===o.readyState&&e.signal.removeEventListener("abort",r)}),o.send(void 0===e._bodyInit?null:e._bodyInit)})}C.polyfill=!0,h.fetch||(h.fetch=C,h.Headers=d,h.Request=w,h.Response=b),a.Headers=d,a.Request=w,a.Response=b,a.fetch=C,Object.defineProperty(a,"__esModule",{value:!0})}(e),{fetch:x.fetch,Headers:x.Headers,Request:x.Request,Response:x.Response,DOMException:x.DOMException}}}))({Promise:f}),b=g.fetch;g.Request,g.Response,g.Headers;var A,C=(t(x,A=Error),x);function x(t,e,r){void 0===r&&(r={});t=A.call(this,t)||this;return t.code=e,t.details=r,t.name="SignalError",t}var I=1/0,E="[object Symbol]",O=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,S=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,T="\\ud800-\\udfff",R="\\u2700-\\u27bf",B="a-z\\xdf-\\xf6\\xf8-\\xff",j="A-Z\\xc0-\\xd6\\xd8-\\xde",P="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",D="['’]",U="["+P+"]",z="[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]",q="\\d+",k="["+R+"]",N="["+B+"]",L="[^"+T+P+q+R+B+j+"]",M="(?:\\ud83c[\\udde6-\\uddff]){2}",F="[\\ud800-\\udbff][\\udc00-\\udfff]",V="["+j+"]",g="(?:"+N+"|"+L+")",P="(?:"+V+"|"+L+")",R="(?:['’](?:d|ll|m|re|s|t|ve))?",B="(?:['’](?:D|LL|M|RE|S|T|VE))?",j="(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?",L="[\\ufe0e\\ufe0f]?",j=L+j+("(?:\\u200d(?:"+["[^"+T+"]",M,F].join("|")+")"+L+j+")*"),j="(?:"+[k,M,F].join("|")+")"+j,G=RegExp(D,"g"),H=RegExp(z,"g"),Z=RegExp([V+"?"+N+"+"+R+"(?="+[U,V,"$"].join("|")+")",P+"+"+B+"(?="+[U,V+g,"$"].join("|")+")",V+"?"+g+"+"+R,V+"+"+B,q,j].join("|"),"g"),J=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,q="object"==typeof _&&_&&_.Object===Object&&_,j="object"==typeof self&&self&&self.Object===Object&&self,q=q||j||Function("return this")();var K,$=(K={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"ss"},function(t){return null==K?void 0:K[t]});var Y,W=Object.prototype.toString,j=q.Symbol,q=j?j.prototype:void 0,X=q?q.toString:void 0;function Q(t){if("string"==typeof t)return t;if("symbol"==typeof(e=t)||function(t){return!!t&&"object"==typeof t}(e)&&W.call(e)==E)return X?X.call(t):"";var e=t+"";return"0"==e&&1/t==-I?"-0":e}function tt(t){return null==t?"":Q(t)}function et(t){var e,r={};for(e in t)r[at(e)]=t[e];return r}function rt(){return Object.keys(ht).filter(function(t){return ht[t]})}function it(t,e){if(!e)return{currency:t,amount:0};var r=-1!==e.indexOf(".");return(e=Number(null===(e=e.match(/\d|\./g))||void 0===e?void 0:e.join(""))||0)%1!=0||r?e=Math.ceil(100*e):r||(e*=100),{currency:t,amount:e}}function nt(t){return void 0!==(t=null!=t?t:void 0)&&"string"!=typeof t}function ot(t){var a=t.baseUrl,h=t.token;return function(o,s){return void 0===o&&(o=""),void 0===s&&(s={}),u(void 0,void 0,void 0,function(){var r,i,n;return m(this,function(t){switch(t.label){case 0:return i=y({credentials:"include",keepalive:!0,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+h}},s),[4,b(""+("/"===(e=a).charAt(e.length-1)?e:e+"/")+o,i)];case 1:return[4,(n=t.sent()).json()];case 2:if(r=t.sent(),!n.ok)throw i=new C,(n=r.error)&&(i.code=n.code,i.details=n.detail,i.message=n.title),i;return[2,r]}var e})})}}function st(t){console&&console.error&&console.error(t.toString?t.toString():t)}var at=(Y=function(t,e,r){return t+(r?"_":"")+e.toLowerCase()},function(t){return function(t,e,r,i){var n=-1,o=t?t.length:0;for(i&&o&&(r=t[++n]);++n<o;)r=e(r,t[n],n,t);return r}((t=((t=tt(t=t))&&t.replace(S,$).replace(H,"")).replace(G,""),t=tt(t),void 0!==(e=r?undefined:e)?t.match(e)||[]:(function(t){return J.test(t)}(t)?function(t){return t.match(Z)||[]}:function(t){return t.match(O)||[]})(t)),Y,"");var e,r}),ht={collectionPageView:!0,orderCancelation:!0,orderCompletion:!0,orderRefund:!0,pageView:!0,productSearch:!0,productPageView:!0};function ut(){return function(t,e,r){var i=r.value;return r.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return i.apply(this,t)}catch(t){st(t)}},r}}var ct,lt=(t(dt,ct=TypeError),dt);function dt(t){t=ct.call(this,t)||this;return t.name="SignalTypeError",t}var ft,pt="You must call 'init' before using any other method",yt="collections must contain either a collection referenceId or name";(j=ft=ft||{}).LOCALSTORAGE="localstorage",j.COOKIE="cookie";var mt=(_t.prototype._encode=function(e){return Object.keys(e).map(function(t){return[t,e[t]]}).filter(function(t){return!!t[1]}).map(function(t){var e=t[0],t=t[1];return e+"="+encodeURIComponent(t)}).join("&")},_t.prototype._decode=function(t){return t.split("&").reduce(function(t,e){var r=e.split("="),e=r[0],r=r[1];return t[e]=decodeURIComponent(r),t},{v:""})},_t.createInstance=function(t){return new _t(t)},_t.prototype.support=function(){if(this.win.navigator.cookieEnabled&&"object"==typeof this.win.document&&"string"==typeof this.win.document.cookie){var t=Ct.NAMESPACE+"testcookie";if(this.win.document.cookie=t+"=supported",-1!==this.win.document.cookie.indexOf(t))return this.win.document.cookie=t+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT",!0}return!1},_t.prototype.set=function(n,o,s){var a,h;return u(this,void 0,void 0,function(){var e,r,i;return m(this,function(t){return n&&(i=null===(a=null==s?void 0:s.expires)||void 0===a?void 0:a.toUTCString(),e=i?";expires="+i:"",r={v:o,t:null==s||!s.expires||null==s?void 0:s.ttl,e:null==s||!s.ttl||null===(h=s.expires)||void 0===h?void 0:h.getTime()},i=""+Ct.NAMESPACE+n,this.win.document.cookie=i+"="+encodeURIComponent(this._encode(r))+e+"; path=/"),[2]})})},_t.prototype.get=function(n){return u(this,void 0,void 0,function(){var e,r,i;return m(this,function(t){switch(t.label){case 0:if(!n)return[2];if(i=""+Ct.NAMESPACE+n,!(r=this.win.document.cookie.match(new RegExp(i+"=(.*?)(?:;|$)"))))return[3,5];t.label=1;case 1:return(t.trys.push([1,4,,5]),e=this._decode(decodeURIComponent(r[1])))?(i=e.e,r=e.t,i&&r?((i=new Date).setMilliseconds(r),i={ttl:r,expires:i},[4,this.set(n,e.v,i)]):[3,3]):[2];case 2:t.sent(),t.label=3;case 3:return[2,e.v];case 4:return t.sent(),[2,void 0];case 5:return[2,void 0]}})})},_t.prototype.remove=function(t){var e=new Date;return e.setTime(e.getTime()+-864e5),this.set(t,"",{expires:e})},_t.prototype.clearAll=function(){return u(this,void 0,void 0,function(){var e,r;return m(this,function(t){switch(t.label){case 0:e=0,r=function(t,e,r){void 0===r&&(r=";");for(var i=[],n=0,o=t.split(r);n<o.length;n++){var s=o[n].split("=")[0];s&&s.trim().startsWith(e)&&i.push(s.trim().replace(e,""))}return i}(this.win.document.cookie,Ct.NAMESPACE),t.label=1;case 1:return e<r.length?(r=r[e],[4,this.remove(r)]):[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},_t);function _t(t){void 0===t&&(t=window),this.win=t,this.name=ft.COOKIE}var vt=(wt.createInstance=function(t){return new wt(t)},wt.prototype.support=function(){var t=Ct.NAMESPACE+"testlocalstorage";try{return this.win.localStorage.setItem(t,"test"),this.win.localStorage.removeItem(t),!0}catch(t){return!1}},wt.prototype.set=function(i,n,o){return u(this,void 0,void 0,function(){var e,r;return m(this,function(t){return i&&(e=""+Ct.NAMESPACE+i,r={value:n,options:o},this.win.localStorage.setItem(e,JSON.stringify(r))),[2]})})},wt.prototype.get=function(n){return u(this,void 0,void 0,function(){var e,r,i;return m(this,function(t){switch(t.label){case 0:if(!n)return[2];if(e=""+Ct.NAMESPACE+n,!(e=this.win.localStorage.getItem(e)))return[2];t.label=1;case 1:return t.trys.push([1,6,,7]),r=JSON.parse(e),i=r.options,(i=null==i?void 0:i.expires)&&new Date>new Date(i)?[4,this.remove(n)]:[3,3];case 2:return t.sent(),[2,void 0];case 3:return i&&"identityId"===n&&new Date(1723824e6)>new Date(i)?[4,this.remove(n)]:[3,5];case 4:return t.sent(),[2,void 0];case 5:return[2,r.value];case 6:return t.sent(),[2,void 0];case 7:return[2]}})})},wt.prototype.remove=function(r){return u(this,void 0,void 0,function(){var e;return m(this,function(t){return e=""+Ct.NAMESPACE+r,this.win.localStorage.removeItem(e),[2]})})},wt.prototype.clearAll=function(){return u(this,void 0,void 0,function(){var e,r,i,n;return m(this,function(t){for(e=Object.keys(this.win.localStorage).filter(function(t){return t.startsWith(Ct.NAMESPACE)}),r=0,i=e;r<i.length;r++)n=i[r],this.win.localStorage.removeItem(n);return[2]})})},wt);function wt(t){void 0===t&&(t=window),this.win=t,this.name=ft.LOCALSTORAGE}function gt(){return u(void 0,void 0,void 0,function(){return m(this,function(t){return[2,void 0]})})}var bt="signal",At=[ft.LOCALSTORAGE,ft.COOKIE],Ct=(xt.prototype.getDriver=function(){return this._driverInstance},xt.createInstance=function(t,e){return xt.instance=new xt(t,e)},xt.getInstance=function(){return xt.instance||xt.createInstance(),xt.instance},xt.prototype.set=function(t,e,r){return this._driverInstance?this._driverInstance.set(t,e.toString(),r):gt()},xt.prototype.get=function(t,e){return this._driverInstance?this._driverInstance.get(t,e):gt()},xt.prototype.remove=function(t){return this._driverInstance?this._driverInstance.remove(t):gt()},xt.prototype.clearAll=function(){return this._driverInstance?this._driverInstance.clearAll():gt()},xt.NAMESPACE=bt+"_",xt);function xt(t,e){void 0===t&&(t=window),void 0===e&&(e=At),this.win=t,this._driverInstance=function(t,e){for(var r=0,i=t;r<i.length;r++){var n=e[i[r]];if(n.support())return n}}(e,(t=this.win,(e={})[ft.LOCALSTORAGE]=vt.createInstance(t),e[ft.COOKIE]=mt.createInstance(t),e))}var It,Et=Ct.getInstance;(q=It=It||{}).PageView="tracking_website_page_view",q.OrderCompletion="tracking_commerce_order_completion",q.ProductPageView="tracking_commerce_product_page_view",q.ProductSearch="tracking_commerce_product_search",q.CollectionPageView="tracking_commerce_collection_page_view",q.OrderRefund="tracking_commerce_order_refund",q.OrderCancelation="tracking_commerce_order_cancelation";function Ot(t){return!!t.referenceId||!!t.name}function St(e,t){if(null==t||!t.referenceId||null!==(r=t.variants)&&void 0!==r&&r.some(function(t){return!t.referenceId}))throw new lt("referenceId is required within product or product.variants");if(null!==(r=t.variants)&&void 0!==r&&r.some(function(t){return nt(t.price)}))throw new lt("variants items price value must be a string");var r=null===(r=t.collections)||void 0===r?void 0:r.filter(function(t){return"string"==typeof t||Array.isArray(t)});if(null==r?void 0:r.filter(function(t){return"string"!=typeof t}).some(function(t){return t.some(function(t){return!Ot(t)})}))throw new lt(yt);return y(y({},t),{variants:null===(t=t.variants)||void 0===t?void 0:t.map(function(t){return y(y({},t),{price:it(e,t.price)})}),collections:r})}function Tt(t){var e;return y(y({},et(t)),{variants:null===(e=t.variants)||void 0===e?void 0:e.map(et),collections:null===(t=t.collections)||void 0===t?void 0:t.map(function(t){return"string"==typeof t?t:t.map(et)})})}function Rt(e,t){var r,i;if(null==t||!t.referenceId||null!==(r=t.items)&&void 0!==r&&r.some(function(t){return!t.referenceId}))throw new lt("referenceId is required within an order or order.items");if(nt(t.discount)||nt(t.subtotal)||null!==(i=t.items)&&void 0!==i&&i.some(function(t){return nt(t.discount)||nt(t.price)}))throw new lt("order.discount, order.subtotal or one of the items within the order has an invalid discount or price. Value must be a string");return y(y({},t),{items:null===(i=t.items)||void 0===i?void 0:i.map(function(t){return y(y({},t),{discount:it(e,t.discount),price:it(e,t.price)})}),discount:it(e,t.discount),subtotal:it(e,t.subtotal)})}var Bt=(jt.prototype.constructRequest=function(t,e){if(r=t,-1===rt().indexOf(r))throw new lt(t+" is not a supported event type, see available types: "+rt().join(","));var r;switch(t){case"pageView":return this.pageViewRequest(e);case"orderCompletion":return this.orderCompletionRequest(e);case"productPageView":return this.productPageViewRequest(e);case"productSearch":return this.productSearchRequest(e);case"collectionPageView":return this.collectionPageViewRequest(e);case"orderRefund":return this.orderRefundRequest(e);case"orderCancelation":return this.orderCancelationRequest(e)}},jt.prototype.pageViewRequest=function(o){return u(this,void 0,void 0,function(){var e,r,i,n;return m(this,function(t){switch(t.label){case 0:return e={url:window.location.href,title:window.document.title,referrer:window.document.referrer},[4,this.signal.getBrowserId()];case 1:return r=t.sent(),[4,this.signal.getSessionId()];case 2:return i=t.sent(),[4,Et().get("identityId")];case 3:return n=t.sent(),n=y(y(y({},e),o||{}),{browserId:r,sessionId:i,identityId:n}),[2,{resource:It.PageView,action:"create",params:et(n)}]}})})},jt.prototype.orderCompletionRequest=function(o){var s;return u(this,void 0,void 0,function(){var e,r,i,n;return m(this,function(t){switch(t.label){case 0:return e=Rt(this.signal.currencyCode,null==o?void 0:o.order),[4,this.signal.getBrowserId()];case 1:return r=t.sent(),[4,this.signal.getSessionId()];case 2:return i=t.sent(),[4,Et().get("identityId")];case 3:return n=t.sent(),n=y(y({},o||{}),{order:y(y({},et(e)),{items:null===(s=e.items)||void 0===s?void 0:s.map(et)}),browserId:r,sessionId:i,identityId:n}),[2,{resource:It.OrderCompletion,action:"create",params:et(n)}]}})})},jt.prototype.productPageViewRequest=function(s){return u(this,void 0,void 0,function(){var e,r,i,n,o;return m(this,function(t){switch(t.label){case 0:return e=St(this.signal.currencyCode,null==s?void 0:s.product),r={url:window.location.href,title:window.document.title,referrer:window.document.referrer},[4,this.signal.getBrowserId()];case 1:return i=t.sent(),[4,this.signal.getSessionId()];case 2:return n=t.sent(),[4,Et().get("identityId")];case 3:return o=t.sent(),o=y(y(y({},r),s||{}),{product:Tt(e),browserId:i,sessionId:n,identityId:o}),[2,{action:"create",resource:It.ProductPageView,params:et(o)}]}})})},jt.prototype.productSearchRequest=function(s){var a;return u(this,void 0,void 0,function(){var e,r,i,n,o=this;return m(this,function(t){switch(t.label){case 0:if(null==s||!s.query)throw new lt("query is required");return e=null===(a=null==s?void 0:s.products)||void 0===a?void 0:a.map(function(t){return St(o.signal.currencyCode,t)}),[4,this.signal.getBrowserId()];case 1:return r=t.sent(),[4,this.signal.getSessionId()];case 2:return i=t.sent(),[4,Et().get("identityId")];case 3:return n=t.sent(),n=y(y({},s),{products:null==e?void 0:e.map(Tt),browserId:r,sessionId:i,identityId:n}),[2,{action:"create",resource:It.ProductSearch,params:et(n)}]}})})},jt.prototype.collectionPageViewRequest=function(o){var s;return u(this,void 0,void 0,function(){var e,r,i,n;return m(this,function(t){switch(t.label){case 0:if(!(null!=o&&o.breadcrumb||null!=o&&o.collection))throw new lt("breadcrumbs or collection is required");if(null!==(s=null==o?void 0:o.collection)&&void 0!==s&&s.some(function(t){return!Ot(t)}))throw new lt(yt);return e={url:window.location.href,title:window.document.title,referrer:window.document.referrer},[4,this.signal.getBrowserId()];case 1:return r=t.sent(),[4,this.signal.getSessionId()];case 2:return i=t.sent(),[4,Et().get("identityId")];case 3:return n=t.sent(),n=y(y(y({},e),o||{}),{collection:null===(s=null==o?void 0:o.collection)||void 0===s?void 0:s.map(et),browserId:r,sessionId:i,identityId:n}),[2,{action:"create",resource:It.CollectionPageView,params:et(n)}]}})})},jt.prototype.orderRefundRequest=function(o){var s;return u(this,void 0,void 0,function(){var e,r,i,n;return m(this,function(t){switch(t.label){case 0:return e=Rt(this.signal.currencyCode,null==o?void 0:o.order),[4,this.signal.getBrowserId()];case 1:return r=t.sent(),[4,this.signal.getSessionId()];case 2:return i=t.sent(),[4,Et().get("identityId")];case 3:return n=t.sent(),n=y(y({},o||{}),{order:y(y({},et(e)),{items:null===(s=e.items)||void 0===s?void 0:s.map(et)}),browserId:r,sessionId:i,identityId:n}),[2,{action:"create",resource:It.OrderRefund,params:et(n)}]}})})},jt.prototype.orderCancelationRequest=function(o){var s;return u(this,void 0,void 0,function(){var e,r,i,n;return m(this,function(t){switch(t.label){case 0:return e=Rt(this.signal.currencyCode,null==o?void 0:o.order),[4,this.signal.getBrowserId()];case 1:return r=t.sent(),[4,this.signal.getSessionId()];case 2:return i=t.sent(),[4,Et().get("identityId")];case 3:return n=t.sent(),n=y(y({},o||{}),{order:y(y({},et(e)),{items:null===(s=e.items)||void 0===s?void 0:s.map(et)}),browserId:r,sessionId:i,identityId:n}),[2,{action:"create",resource:It.OrderCancelation,params:et(n)}]}})})},jt);function jt(t){this.signal=t}var Pt=(Dt.prototype.push=function(t){this.calls.push(y(y({},t),{isCompleted:!1})),this.running||this._listen()},Dt.prototype.pushSync=function(t){this._process([y(y({},t),{isCompleted:!1})]),this.calls.push(y(y({},t),{isCompleted:!0}))},Dt.prototype._listen=function(){var t=this;this.running=!0,setTimeout(function(){return u(t,void 0,void 0,function(){var e,r,i=this;return m(this,function(t){switch(t.label){case 0:if(0===(e=this.calls.filter(function(t){return!t.isCompleted}).slice(0,this.limit)).length)return this.running=!1,[2];t.label=1;case 1:return t.trys.push([1,6,,7]),this.onBatchProcess?[4,this.onBatchProcess(e)]:[3,3];case 2:return t.sent(),[3,5];case 3:return[4,this._process(e)];case 4:t.sent(),t.label=5;case 5:return[3,7];case 6:return r=t.sent(),st(r),[3,7];case 7:return e.forEach(function(t){return i._markAsCompleted(t)}),this.onBatchDone(e.length),this._listen(),[2]}})})},this.timeout)},Dt.prototype._process=function(n){return u(this,void 0,void 0,function(){return m(this,function(t){switch(t.label){case 0:if(!this.signal)throw new Error("Signal instance is required");return[4,this.signal.getFetchInstance()(this.signal.version+"/batches",{method:"POST",body:JSON.stringify({batch:{requests:n.map(function(t){return t.request})}})})];case 1:return t.sent().batch.requests.forEach(function(t,e){var r=n[e];if(r.onDone)try{if("error"===t.status){var i=new C;return i.code=t.result.code,i.details=t.result.detail,i.message=t.result.title,void r.onDone(i)}r.onDone(void 0,t.result)}catch(t){}}),[2]}})})},Dt.prototype._markAsCompleted=function(t){t.isCompleted=!0},Dt.prototype.setOnBatchDone=function(t){this.onBatchDone=t},Dt);function Dt(t,e){var r=void 0===t?{}:t,i=r.timeout,n=void 0===i?150:i,t=r.limit,i=void 0===t?5:t,t=r.onBatchDone,t=void 0===t?function(){}:t,r=r.onBatchProcess;this.signal=e,this.calls=[],this.running=!1,this.timeout=n,this.limit=i,this.onBatchDone=t,this.onBatchProcess=r}var j={UINT32:w(function(t){function i(t,e){return this instanceof i?(this._low=0,this._high=0,this.remainder=null,void 0===e?n.call(this,t):"string"==typeof t?o.call(this,t,e):void r.call(this,t,e)):new i(t,e)}function r(t,e){return this._low=0|t,this._high=0|e,this}function n(t){return this._low=65535&t,this._high=t>>>16,this}function o(t,e){e=parseInt(t,e||10);return this._low=65535&e,this._high=e>>>16,this}var e;e=_,i(Math.pow(36,5)),i(Math.pow(16,7)),i(Math.pow(10,9)),i(Math.pow(2,30)),i(36),i(16),i(10),i(2),i.prototype.fromBits=r,i.prototype.fromNumber=n,i.prototype.fromString=o,i.prototype.toNumber=function(){return 65536*this._high+this._low},i.prototype.toString=function(t){return this.toNumber().toString(t||10)},i.prototype.add=function(t){var e=this._low+t._low,r=e>>>16;return r+=this._high+t._high,this._low=65535&e,this._high=65535&r,this},i.prototype.subtract=function(t){return this.add(t.clone().negate())},i.prototype.multiply=function(t){var e=this._high,r=this._low,i=t._high,n=t._low,o=r*n,t=o>>>16;return t+=e*n,t&=65535,t+=r*i,this._low=65535&o,this._high=65535&t,this},i.prototype.div=function(t){if(0==t._low&&0==t._high)throw Error("division by zero");if(0==t._high&&1==t._low)return this.remainder=new i(0),this;if(t.gt(this))return this.remainder=this.clone(),this._low=0,this._high=0,this;if(this.eq(t))return this.remainder=new i(0),this._low=1,this._high=0,this;for(var e=t.clone(),r=-1;!this.lt(e);)e.shiftLeft(1,!0),r++;for(this.remainder=this.clone(),this._low=0,this._high=0;0<=r;r--)e.shiftRight(1),this.remainder.lt(e)||(this.remainder.subtract(e),16<=r?this._high|=1<<r-16:this._low|=1<<r);return this},i.prototype.negate=function(){var t=1+(65535&~this._low);return this._low=65535&t,this._high=~this._high+(t>>>16)&65535,this},i.prototype.equals=i.prototype.eq=function(t){return this._low==t._low&&this._high==t._high},i.prototype.greaterThan=i.prototype.gt=function(t){return this._high>t._high||!(this._high<t._high)&&this._low>t._low},i.prototype.lessThan=i.prototype.lt=function(t){return this._high<t._high||!(this._high>t._high)&&this._low<t._low},i.prototype.or=function(t){return this._low|=t._low,this._high|=t._high,this},i.prototype.and=function(t){return this._low&=t._low,this._high&=t._high,this},i.prototype.not=function(){return this._low=65535&~this._low,this._high=65535&~this._high,this},i.prototype.xor=function(t){return this._low^=t._low,this._high^=t._high,this},i.prototype.shiftRight=i.prototype.shiftr=function(t){return 16<t?(this._low=this._high>>t-16,this._high=0):16==t?(this._low=this._high,this._high=0):(this._low=this._low>>t|this._high<<16-t&65535,this._high>>=t),this},i.prototype.shiftLeft=i.prototype.shiftl=function(t,e){return 16<t?(this._high=this._low<<t-16,this._low=0,e||(this._high&=65535)):16==t?(this._high=this._low,this._low=0):(this._high=this._high<<t|this._low>>16-t,this._low=this._low<<t&65535,e||(this._high&=65535)),this},i.prototype.rotateLeft=i.prototype.rotl=function(t){var e=(e=this._high<<16|this._low)<<t|e>>>32-t;return this._low=65535&e,this._high=e>>>16,this},i.prototype.rotateRight=i.prototype.rotr=function(t){var e=(e=this._high<<16|this._low)>>>t|e<<32-t;return this._low=65535&e,this._high=e>>>16,this},i.prototype.clone=function(){return new i(this._low,this._high)},t.exports?t.exports=i:e.UINT32=i}),UINT64:w(function(t){function a(t,e,r,i){return this instanceof a?(this.remainder=null,"string"==typeof t?s.call(this,t,e):void 0===e?o.call(this,t):void n.apply(this,arguments)):new a(t,e,r,i)}function n(t,e,r,i){return void 0===r?(this._a00=65535&t,this._a16=t>>>16,this._a32=65535&e,this._a48=e>>>16):(this._a00=0|t,this._a16=0|e,this._a32=0|r,this._a48=0|i),this}function o(t){return this._a00=65535&t,this._a16=t>>>16,this._a32=0,this._a48=0,this}function s(t,e){e=e||10,this._a00=0,this._a16=0,this._a32=0,this._a48=0;for(var r=h[e]||new a(Math.pow(e,5)),i=0,n=t.length;i<n;i+=5){var o=Math.min(5,n-i),s=parseInt(t.slice(i,i+o),e);this.multiply(o<5?new a(Math.pow(e,o)):r).add(new a(s))}return this}var e,h,u;e=_,h={16:a(Math.pow(16,5)),10:a(Math.pow(10,5)),2:a(Math.pow(2,5))},u={16:a(16),10:a(10),2:a(2)},a.prototype.fromBits=n,a.prototype.fromNumber=o,a.prototype.fromString=s,a.prototype.toNumber=function(){return 65536*this._a16+this._a00},a.prototype.toString=function(t){var e=u[t=t||10]||new a(t);if(!this.gt(e))return this.toNumber().toString(t);for(var r=this.clone(),i=new Array(64),n=63;0<=n&&(r.div(e),i[n]=r.remainder.toNumber().toString(t),r.gt(e));n--);return i[n-1]=r.toNumber().toString(t),i.join("")},a.prototype.add=function(t){var e=this._a00+t._a00,r=e>>>16,i=(r+=this._a16+t._a16)>>>16,n=(i+=this._a32+t._a32)>>>16;return n+=this._a48+t._a48,this._a00=65535&e,this._a16=65535&r,this._a32=65535&i,this._a48=65535&n,this},a.prototype.subtract=function(t){return this.add(t.clone().negate())},a.prototype.multiply=function(t){var e=this._a00,r=this._a16,i=this._a32,n=this._a48,o=t._a00,s=t._a16,a=t._a32,h=e*o,u=h>>>16,c=(u+=e*s)>>>16;u&=65535,c+=(u+=r*o)>>>16;var l=(c+=e*a)>>>16;return c&=65535,l+=(c+=r*s)>>>16,c&=65535,l+=(c+=i*o)>>>16,l+=e*t._a48,l&=65535,l+=r*a,l&=65535,l+=i*s,l&=65535,l+=n*o,this._a00=65535&h,this._a16=65535&u,this._a32=65535&c,this._a48=65535&l,this},a.prototype.div=function(t){if(0==t._a16&&0==t._a32&&0==t._a48){if(0==t._a00)throw Error("division by zero");if(1==t._a00)return this.remainder=new a(0),this}if(t.gt(this))return this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0,this;if(this.eq(t))return this.remainder=new a(0),this._a00=1,this._a16=0,this._a32=0,this._a48=0,this;for(var e=t.clone(),r=-1;!this.lt(e);)e.shiftLeft(1,!0),r++;for(this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0;0<=r;r--)e.shiftRight(1),this.remainder.lt(e)||(this.remainder.subtract(e),48<=r?this._a48|=1<<r-48:32<=r?this._a32|=1<<r-32:16<=r?this._a16|=1<<r-16:this._a00|=1<<r);return this},a.prototype.negate=function(){var t=1+(65535&~this._a00);return this._a00=65535&t,t=(65535&~this._a16)+(t>>>16),this._a16=65535&t,t=(65535&~this._a32)+(t>>>16),this._a32=65535&t,this._a48=~this._a48+(t>>>16)&65535,this},a.prototype.equals=a.prototype.eq=function(t){return this._a48==t._a48&&this._a00==t._a00&&this._a32==t._a32&&this._a16==t._a16},a.prototype.greaterThan=a.prototype.gt=function(t){return this._a48>t._a48||!(this._a48<t._a48)&&(this._a32>t._a32||!(this._a32<t._a32)&&(this._a16>t._a16||!(this._a16<t._a16)&&this._a00>t._a00))},a.prototype.lessThan=a.prototype.lt=function(t){return this._a48<t._a48||!(this._a48>t._a48)&&(this._a32<t._a32||!(this._a32>t._a32)&&(this._a16<t._a16||!(this._a16>t._a16)&&this._a00<t._a00))},a.prototype.or=function(t){return this._a00|=t._a00,this._a16|=t._a16,this._a32|=t._a32,this._a48|=t._a48,this},a.prototype.and=function(t){return this._a00&=t._a00,this._a16&=t._a16,this._a32&=t._a32,this._a48&=t._a48,this},a.prototype.xor=function(t){return this._a00^=t._a00,this._a16^=t._a16,this._a32^=t._a32,this._a48^=t._a48,this},a.prototype.not=function(){return this._a00=65535&~this._a00,this._a16=65535&~this._a16,this._a32=65535&~this._a32,this._a48=65535&~this._a48,this},a.prototype.shiftRight=a.prototype.shiftr=function(t){return 48<=(t%=64)?(this._a00=this._a48>>t-48,this._a16=0,this._a32=0,this._a48=0):32<=t?(t-=32,this._a00=65535&(this._a32>>t|this._a48<<16-t),this._a16=this._a48>>t&65535,this._a32=0,this._a48=0):16<=t?(t-=16,this._a00=65535&(this._a16>>t|this._a32<<16-t),this._a16=65535&(this._a32>>t|this._a48<<16-t),this._a32=this._a48>>t&65535,this._a48=0):(this._a00=65535&(this._a00>>t|this._a16<<16-t),this._a16=65535&(this._a16>>t|this._a32<<16-t),this._a32=65535&(this._a32>>t|this._a48<<16-t),this._a48=this._a48>>t&65535),this},a.prototype.shiftLeft=a.prototype.shiftl=function(t,e){return 48<=(t%=64)?(this._a48=this._a00<<t-48,this._a32=0,this._a16=0,this._a00=0):32<=t?(t-=32,this._a48=this._a16<<t|this._a00>>16-t,this._a32=this._a00<<t&65535,this._a16=0,this._a00=0):16<=t?(t-=16,this._a48=this._a32<<t|this._a16>>16-t,this._a32=65535&(this._a16<<t|this._a00>>16-t),this._a16=this._a00<<t&65535,this._a00=0):(this._a48=this._a48<<t|this._a32>>16-t,this._a32=65535&(this._a32<<t|this._a16>>16-t),this._a16=65535&(this._a16<<t|this._a00>>16-t),this._a00=this._a00<<t&65535),e||(this._a48&=65535),this},a.prototype.rotateLeft=a.prototype.rotl=function(t){if(0==(t%=64))return this;if(32<=t){var e=this._a00;if(this._a00=this._a32,this._a32=e,e=this._a48,this._a48=this._a16,this._a16=e,32==t)return this;t-=32}var r=this._a48<<16|this._a32,i=this._a16<<16|this._a00,e=r<<t|i>>>32-t,t=i<<t|r>>>32-t;return this._a00=65535&t,this._a16=t>>>16,this._a32=65535&e,this._a48=e>>>16,this},a.prototype.rotateRight=a.prototype.rotr=function(t){if(0==(t%=64))return this;if(32<=t){var e=this._a00;if(this._a00=this._a32,this._a32=e,e=this._a48,this._a48=this._a16,this._a16=e,32==t)return this;t-=32}var r=this._a48<<16|this._a32,i=this._a16<<16|this._a00,e=r>>>t|i<<32-t,t=i>>>t|r<<32-t;return this._a00=65535&t,this._a16=t>>>16,this._a32=65535&e,this._a48=e>>>16,this},a.prototype.clone=function(){return new a(this._a00,this._a16,this._a32,this._a48)},t.exports?t.exports=a:e.UINT64=a})},Ut=j.UINT32;Ut.prototype.xxh_update=function(t,e){var r=qt._low,i=t*r,n=i>>>16;n+=e*r,n&=65535,n+=t*qt._high;var o=this._low+(65535&i),e=o>>>16,t=(e+=this._high+(65535&n))<<16|65535&o,e=(t=t<<13|t>>>19)>>>16;n=(i=(o=65535&t)*(r=zt._low))>>>16,n+=e*r,n&=65535,n+=o*zt._high,this._low=65535&i,this._high=65535&n};var zt=Ut("2654435761"),qt=Ut("2246822519"),kt=Ut("3266489917"),Nt=Ut("668265263"),Lt=Ut("374761393");function Mt(){return 2==arguments.length?new Mt(arguments[1]).update(arguments[0]).digest():this instanceof Mt?void Ft.call(this,arguments[0]):new Mt(arguments[0])}function Ft(t){return this.seed=t instanceof Ut?t.clone():Ut(t),this.v1=this.seed.clone().add(zt).add(qt),this.v2=this.seed.clone().add(qt),this.v3=this.seed.clone(),this.v4=this.seed.clone().subtract(zt),this.total_len=0,this.memsize=0,this.memory=null,this}Mt.prototype.init=Ft,Mt.prototype.update=function(t){var e,r="string"==typeof t;r&&(t=function(t){for(var e=[],r=0,i=t.length;r<i;r++){var n=t.charCodeAt(r);n<128?e.push(n):n<2048?e.push(192|n>>6,128|63&n):n<55296||57344<=n?e.push(224|n>>12,128|n>>6&63,128|63&n):(r++,n=65536+((1023&n)<<10|1023&t.charCodeAt(r)),e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return new Uint8Array(e)}(t),e=!(r=!1)),"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&(e=!0,t=new Uint8Array(t));var i=0,n=t.length,o=i+n;if(0==n)return this;if(this.total_len+=n,0==this.memsize&&(this.memory=r?"":new(e?Uint8Array:Buffer)(16)),this.memsize+n<16)return r?this.memory+=t:e?this.memory.set(t.subarray(0,n),this.memsize):t.copy(this.memory,this.memsize,0,n),this.memsize+=n,this;if(0<this.memsize&&(r?this.memory+=t.slice(0,16-this.memsize):e?this.memory.set(t.subarray(0,16-this.memsize),this.memsize):t.copy(this.memory,this.memsize,0,16-this.memsize),n=0,r?(this.v1.xxh_update(this.memory.charCodeAt(n+1)<<8|this.memory.charCodeAt(n),this.memory.charCodeAt(n+3)<<8|this.memory.charCodeAt(n+2)),n+=4,this.v2.xxh_update(this.memory.charCodeAt(n+1)<<8|this.memory.charCodeAt(n),this.memory.charCodeAt(n+3)<<8|this.memory.charCodeAt(n+2)),n+=4,this.v3.xxh_update(this.memory.charCodeAt(n+1)<<8|this.memory.charCodeAt(n),this.memory.charCodeAt(n+3)<<8|this.memory.charCodeAt(n+2)),n+=4,this.v4.xxh_update(this.memory.charCodeAt(n+1)<<8|this.memory.charCodeAt(n),this.memory.charCodeAt(n+3)<<8|this.memory.charCodeAt(n+2))):(this.v1.xxh_update(this.memory[n+1]<<8|this.memory[n],this.memory[n+3]<<8|this.memory[n+2]),n+=4,this.v2.xxh_update(this.memory[n+1]<<8|this.memory[n],this.memory[n+3]<<8|this.memory[n+2]),n+=4,this.v3.xxh_update(this.memory[n+1]<<8|this.memory[n],this.memory[n+3]<<8|this.memory[n+2]),n+=4,this.v4.xxh_update(this.memory[n+1]<<8|this.memory[n],this.memory[n+3]<<8|this.memory[n+2])),i+=16-this.memsize,this.memsize=0,r&&(this.memory="")),i<=o-16)for(var s=o-16;r?(this.v1.xxh_update(t.charCodeAt(i+1)<<8|t.charCodeAt(i),t.charCodeAt(i+3)<<8|t.charCodeAt(i+2)),i+=4,this.v2.xxh_update(t.charCodeAt(i+1)<<8|t.charCodeAt(i),t.charCodeAt(i+3)<<8|t.charCodeAt(i+2)),i+=4,this.v3.xxh_update(t.charCodeAt(i+1)<<8|t.charCodeAt(i),t.charCodeAt(i+3)<<8|t.charCodeAt(i+2)),i+=4,this.v4.xxh_update(t.charCodeAt(i+1)<<8|t.charCodeAt(i),t.charCodeAt(i+3)<<8|t.charCodeAt(i+2))):(this.v1.xxh_update(t[i+1]<<8|t[i],t[i+3]<<8|t[i+2]),i+=4,this.v2.xxh_update(t[i+1]<<8|t[i],t[i+3]<<8|t[i+2]),i+=4,this.v3.xxh_update(t[i+1]<<8|t[i],t[i+3]<<8|t[i+2]),i+=4,this.v4.xxh_update(t[i+1]<<8|t[i],t[i+3]<<8|t[i+2])),i+=4,i<=s;);return i<o&&(r?this.memory+=t.slice(i):e?this.memory.set(t.subarray(i,o),this.memsize):t.copy(this.memory,this.memsize,i,o),this.memsize=o-i),this},Mt.prototype.digest=function(){var t,e=this.memory,r="string"==typeof e,i=0,n=this.memsize,o=new Ut,s=16<=this.total_len?this.v1.rotl(1).add(this.v2.rotl(7).add(this.v3.rotl(12).add(this.v4.rotl(18)))):this.seed.clone().add(Lt);for(s.add(o.fromNumber(this.total_len));i<=n-4;)r?o.fromBits(e.charCodeAt(i+1)<<8|e.charCodeAt(i),e.charCodeAt(i+3)<<8|e.charCodeAt(i+2)):o.fromBits(e[i+1]<<8|e[i],e[i+3]<<8|e[i+2]),s.add(o.multiply(kt)).rotl(17).multiply(Nt),i+=4;for(;i<n;)o.fromBits(r?e.charCodeAt(i++):e[i++],0),s.add(o.multiply(Lt)).rotl(11).multiply(zt);return t=s.clone().shiftRight(15),s.xor(t).multiply(qt),t=s.clone().shiftRight(13),s.xor(t).multiply(kt),t=s.clone().shiftRight(16),s.xor(t),this.init(this.seed),s};var q=Mt,Vt=j.UINT64,Gt=Vt("11400714785074694791"),Ht=Vt("14029467366897019727"),Zt=Vt("1609587929392839161"),Jt=Vt("9650029242287828579"),Kt=Vt("2870177450012600261");function $t(){return 2==arguments.length?new $t(arguments[1]).update(arguments[0]).digest():this instanceof $t?void Yt.call(this,arguments[0]):new $t(arguments[0])}function Yt(t){return this.seed=t instanceof Vt?t.clone():Vt(t),this.v1=this.seed.clone().add(Gt).add(Ht),this.v2=this.seed.clone().add(Ht),this.v3=this.seed.clone(),this.v4=this.seed.clone().subtract(Gt),this.total_len=0,this.memsize=0,this.memory=null,this}$t.prototype.init=Yt,$t.prototype.update=function(t){var e,r="string"==typeof t;r&&(t=function(t){for(var e=[],r=0,i=t.length;r<i;r++){var n=t.charCodeAt(r);n<128?e.push(n):n<2048?e.push(192|n>>6,128|63&n):n<55296||57344<=n?e.push(224|n>>12,128|n>>6&63,128|63&n):(r++,n=65536+((1023&n)<<10|1023&t.charCodeAt(r)),e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return new Uint8Array(e)}(t),e=!(r=!1)),"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&(e=!0,t=new Uint8Array(t));var i=0,n=t.length,o=i+n;if(0==n)return this;if(this.total_len+=n,0==this.memsize&&(this.memory=r?"":new(e?Uint8Array:Buffer)(32)),this.memsize+n<32)return r?this.memory+=t:e?this.memory.set(t.subarray(0,n),this.memsize):t.copy(this.memory,this.memsize,0,n),this.memsize+=n,this;if(0<this.memsize&&(r?this.memory+=t.slice(0,32-this.memsize):e?this.memory.set(t.subarray(0,32-this.memsize),this.memsize):t.copy(this.memory,this.memsize,0,32-this.memsize),n=0,s=r?(s=Vt(this.memory.charCodeAt(n+1)<<8|this.memory.charCodeAt(n),this.memory.charCodeAt(n+3)<<8|this.memory.charCodeAt(n+2),this.memory.charCodeAt(n+5)<<8|this.memory.charCodeAt(n+4),this.memory.charCodeAt(n+7)<<8|this.memory.charCodeAt(n+6)),this.v1.add(s.multiply(Ht)).rotl(31).multiply(Gt),n+=8,s=Vt(this.memory.charCodeAt(n+1)<<8|this.memory.charCodeAt(n),this.memory.charCodeAt(n+3)<<8|this.memory.charCodeAt(n+2),this.memory.charCodeAt(n+5)<<8|this.memory.charCodeAt(n+4),this.memory.charCodeAt(n+7)<<8|this.memory.charCodeAt(n+6)),this.v2.add(s.multiply(Ht)).rotl(31).multiply(Gt),n+=8,s=Vt(this.memory.charCodeAt(n+1)<<8|this.memory.charCodeAt(n),this.memory.charCodeAt(n+3)<<8|this.memory.charCodeAt(n+2),this.memory.charCodeAt(n+5)<<8|this.memory.charCodeAt(n+4),this.memory.charCodeAt(n+7)<<8|this.memory.charCodeAt(n+6)),this.v3.add(s.multiply(Ht)).rotl(31).multiply(Gt),n+=8,Vt(this.memory.charCodeAt(n+1)<<8|this.memory.charCodeAt(n),this.memory.charCodeAt(n+3)<<8|this.memory.charCodeAt(n+2),this.memory.charCodeAt(n+5)<<8|this.memory.charCodeAt(n+4),this.memory.charCodeAt(n+7)<<8|this.memory.charCodeAt(n+6))):(s=Vt(this.memory[n+1]<<8|this.memory[n],this.memory[n+3]<<8|this.memory[n+2],this.memory[n+5]<<8|this.memory[n+4],this.memory[n+7]<<8|this.memory[n+6]),this.v1.add(s.multiply(Ht)).rotl(31).multiply(Gt),n+=8,s=Vt(this.memory[n+1]<<8|this.memory[n],this.memory[n+3]<<8|this.memory[n+2],this.memory[n+5]<<8|this.memory[n+4],this.memory[n+7]<<8|this.memory[n+6]),this.v2.add(s.multiply(Ht)).rotl(31).multiply(Gt),n+=8,s=Vt(this.memory[n+1]<<8|this.memory[n],this.memory[n+3]<<8|this.memory[n+2],this.memory[n+5]<<8|this.memory[n+4],this.memory[n+7]<<8|this.memory[n+6]),this.v3.add(s.multiply(Ht)).rotl(31).multiply(Gt),n+=8,Vt(this.memory[n+1]<<8|this.memory[n],this.memory[n+3]<<8|this.memory[n+2],this.memory[n+5]<<8|this.memory[n+4],this.memory[n+7]<<8|this.memory[n+6])),this.v4.add(s.multiply(Ht)).rotl(31).multiply(Gt),i+=32-this.memsize,this.memsize=0,r&&(this.memory="")),i<=o-32){var s,a=o-32;do{}while(s=r?(s=Vt(t.charCodeAt(i+1)<<8|t.charCodeAt(i),t.charCodeAt(i+3)<<8|t.charCodeAt(i+2),t.charCodeAt(i+5)<<8|t.charCodeAt(i+4),t.charCodeAt(i+7)<<8|t.charCodeAt(i+6)),this.v1.add(s.multiply(Ht)).rotl(31).multiply(Gt),i+=8,s=Vt(t.charCodeAt(i+1)<<8|t.charCodeAt(i),t.charCodeAt(i+3)<<8|t.charCodeAt(i+2),t.charCodeAt(i+5)<<8|t.charCodeAt(i+4),t.charCodeAt(i+7)<<8|t.charCodeAt(i+6)),this.v2.add(s.multiply(Ht)).rotl(31).multiply(Gt),i+=8,s=Vt(t.charCodeAt(i+1)<<8|t.charCodeAt(i),t.charCodeAt(i+3)<<8|t.charCodeAt(i+2),t.charCodeAt(i+5)<<8|t.charCodeAt(i+4),t.charCodeAt(i+7)<<8|t.charCodeAt(i+6)),this.v3.add(s.multiply(Ht)).rotl(31).multiply(Gt),i+=8,Vt(t.charCodeAt(i+1)<<8|t.charCodeAt(i),t.charCodeAt(i+3)<<8|t.charCodeAt(i+2),t.charCodeAt(i+5)<<8|t.charCodeAt(i+4),t.charCodeAt(i+7)<<8|t.charCodeAt(i+6))):(s=Vt(t[i+1]<<8|t[i],t[i+3]<<8|t[i+2],t[i+5]<<8|t[i+4],t[i+7]<<8|t[i+6]),this.v1.add(s.multiply(Ht)).rotl(31).multiply(Gt),s=Vt(t[(i+=8)+1]<<8|t[i],t[i+3]<<8|t[i+2],t[i+5]<<8|t[i+4],t[i+7]<<8|t[i+6]),this.v2.add(s.multiply(Ht)).rotl(31).multiply(Gt),s=Vt(t[(i+=8)+1]<<8|t[i],t[i+3]<<8|t[i+2],t[i+5]<<8|t[i+4],t[i+7]<<8|t[i+6]),this.v3.add(s.multiply(Ht)).rotl(31).multiply(Gt),Vt(t[(i+=8)+1]<<8|t[i],t[i+3]<<8|t[i+2],t[i+5]<<8|t[i+4],t[i+7]<<8|t[i+6])),this.v4.add(s.multiply(Ht)).rotl(31).multiply(Gt),(i+=8)<=a)}return i<o&&(r?this.memory+=t.slice(i):e?this.memory.set(t.subarray(i,o),this.memsize):t.copy(this.memory,this.memsize,i,o),this.memsize=o-i),this},$t.prototype.digest=function(){var t,e,r=this.memory,i="string"==typeof r,n=0,o=this.memsize,s=new Vt;for(32<=this.total_len?((t=this.v1.clone().rotl(1)).add(this.v2.clone().rotl(7)),t.add(this.v3.clone().rotl(12)),t.add(this.v4.clone().rotl(18)),t.xor(this.v1.multiply(Ht).rotl(31).multiply(Gt)),t.multiply(Gt).add(Jt),t.xor(this.v2.multiply(Ht).rotl(31).multiply(Gt)),t.multiply(Gt).add(Jt),t.xor(this.v3.multiply(Ht).rotl(31).multiply(Gt)),t.multiply(Gt).add(Jt),t.xor(this.v4.multiply(Ht).rotl(31).multiply(Gt)),t.multiply(Gt).add(Jt)):t=this.seed.clone().add(Kt),t.add(s.fromNumber(this.total_len));n<=o-8;)i?s.fromBits(r.charCodeAt(n+1)<<8|r.charCodeAt(n),r.charCodeAt(n+3)<<8|r.charCodeAt(n+2),r.charCodeAt(n+5)<<8|r.charCodeAt(n+4),r.charCodeAt(n+7)<<8|r.charCodeAt(n+6)):s.fromBits(r[n+1]<<8|r[n],r[n+3]<<8|r[n+2],r[n+5]<<8|r[n+4],r[n+7]<<8|r[n+6]),s.multiply(Ht).rotl(31).multiply(Gt),t.xor(s).rotl(27).multiply(Gt).add(Jt),n+=8;for(n+4<=o&&(i?s.fromBits(r.charCodeAt(n+1)<<8|r.charCodeAt(n),r.charCodeAt(n+3)<<8|r.charCodeAt(n+2),0,0):s.fromBits(r[n+1]<<8|r[n],r[n+3]<<8|r[n+2],0,0),t.xor(s.multiply(Gt)).rotl(23).multiply(Ht).add(Zt),n+=4);n<o;)s.fromBits(i?r.charCodeAt(n++):r[n++],0,0,0),t.xor(s.multiply(Kt)).rotl(11).multiply(Gt);return e=t.clone().shiftRight(33),t.xor(e).multiply(Ht),e=t.clone().shiftRight(29),t.xor(e).multiply(Zt),e=t.clone().shiftRight(32),t.xor(e),this.init(this.seed),t};var Wt={h32:q,h64:$t};function Xt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}var q=w(function(t,e){function o(r,i){var n,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(r,a)}catch(t){e=[6,t],o=0}finally{n=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}t.exports=function(){function t(){this._isRunning=!1,this.tasks=[]}return t.prototype._running=function(){return u(this,void 0,void 0,function(){var r,i,n;return o(this,function(t){switch(t.label){case 0:return this._isRunning?[4,u(void(e=0),void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t){return setTimeout(t,e)})];case 1:return[2,t.sent()]}})})]:[3,2];case 1:return t.sent(),[3,0];case 2:if(!(0<this.tasks.length))return[3,7];if(this._isRunning=!0,null==(i=this.tasks.shift()))return[3,6];r=i.action,i=i.onDone,i=void 0===i?function(){}:i,t.label=3;case 3:return t.trys.push([3,5,,6]),[4,r()];case 4:return n=t.sent(),i(void 0,n),[3,6];case 5:return n=t.sent(),i(n),[3,6];case 6:return[3,2];case 7:return this._isRunning=!1,[2]}var e})})},t.prototype.push=function(e){return u(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return this.tasks.push(e),[4,this._running()];case 1:return[2,t.sent()]}})})},t}()}),Qt=new q,te=new q,ee=(re.prototype.getBrowserId=function(){var t=this;return new f(function(i,n){return u(t,void 0,void 0,function(){var e,r=this;return m(this,function(t){switch(t.label){case 0:return e=function(){return u(r,void 0,void 0,function(){var e,r,i;return m(this,function(t){switch(t.label){case 0:return!1===this._isInitialized&&n(new C(pt)),[4,Et().get("browserId")];case 1:return(r=t.sent())?[2,r]:(e=31556952e3,i=Date.now(),r=new Date(i+e),i=Xt(),[4,Et().set("browserId",i,{expires:r,ttl:e})]);case 2:return t.sent(),[2,i]}})})},[4,Qt.push({action:e,onDone:function(t,e){if(t)return n(t);i(e)}})];case 1:return t.sent(),[2]}})})})},re.prototype.getSessionId=function(){var t=this;return new f(function(i,n){return u(t,void 0,void 0,function(){var e,r=this;return m(this,function(t){switch(t.label){case 0:return e=function(){return u(r,void 0,void 0,function(){var e,r;return m(this,function(t){switch(t.label){case 0:return!1===this._isInitialized&&n(new C(pt)),[4,Et().get("sessionId",36e5)];case 1:return(e=t.sent())?[2,e]:(r=Date.now(),e=new Date(r+18e5),r=Xt(),[4,Et().set("sessionId",r,{expires:e,ttl:18e5})]);case 2:return t.sent(),[2,r]}})})},[4,te.push({action:e,onDone:function(t,e){if(t)return n(t);i(e)}})];case 1:return t.sent(),[2]}})})})},re.prototype._replayDelayedCalls=function(){for(var t=window[bt];t&&t.length;)try{var e=t.shift()||[],r=e[0],e=e.slice(1),r=this[r];r&&r.apply(this,e)}catch(t){}},re.prototype.init=function(t,e){void 0===e&&(e={}),this._isInitialized=!0;var r=e.baseUrl,r=void 0===r?re.DEFAULT_BASE_URL:r,e=e.currencyCode,e=void 0===e?this.currencyCode:e;if(this.log("init method called"),"string"!=typeof t||!t)throw new lt("'CLIENT_TOKEN' is required and should be a string");if("string"!=typeof r||!r)throw new lt("'options.baseUrl' is required and should be a string or remove it from your options to use the default baseUrl");if("string"!=typeof e||!e)throw new lt("'options.currencyCode' is required and should be a string or remove it from your options to use the default currencyCode");if(3!==e.length)throw new lt("'options.currencyCode' must be 3 characters long");this.currencyCode=e.toUpperCase(),this._token=t,this._fetchInstance=ot({baseUrl:r,token:t}),this.browser(),this.session(),this.identity(),this.log("init method ran successfully")},re.prototype.browser=function(e){var r=this;this.log("browser method called"),this.getBrowserId().then(function(t){e&&e(t),r.log("browser method ran successfully with",t)}).catch(st)},re.prototype.session=function(e){var r=this;this.log("session method called"),this.getSessionId().then(function(t){e&&e(t),r.log("session method ran successfully with",t)}).catch(st)},re.prototype.identity=function(t,e){var r=this;this.log("identity method called");var i=function(t){for(var e={},r=["cp_rid","cp_cid","cp_src","cp_eea"],i=0,n=(t||window.location.search.substring(1)).split("&");i<n.length;i++){var o=n[i].split("="),s=o[0],o=o[1],s=s;-1===r.indexOf(s)||(e[s]=decodeURIComponent(o))}return e}(),n=i.cp_cid,o=i.cp_rid,i=i.cp_src,c=y({},t||{});if(c.referenceId=o||c.referenceId,c.contactId=n||c.contactId,c.source=i||c.source,null==c||!c.emailAddress||null!=c&&c.contactId||(i=null==c?void 0:c.emailAddress.trim().toLocaleLowerCase(),i=Wt.h64(i,0).toString(16),c.contactId=i),null==c||delete c.emailAddress,!c||!c.contactId&&!c.emailAddress)return e&&e(void 0),void this.log("One of emailAddress or contactId must be provided or be available as query string when creating an identity");var l=this.getFetchInstance();u(r,void 0,void 0,function(){var e,r,i,n,o,s,a,h,u;return m(this,function(t){switch(t.label){case 0:return[4,Et().get("identityId")];case 1:return t.sent()?[2,void 0]:[4,this.getBrowserId()];case 2:return e=t.sent(),[4,this.getSessionId()];case 3:for(h=t.sent(),r=new URLSearchParams,i=0,n=Object.entries(c);i<n.length;i++)s=n[i],o=s[0],(s=s[1])&&r.append(at(o),s);return r.append("browser_id",e),r.append("session_id",h),r.append("token",this._token),u={headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}},[4,l(this.version+"/identity?"+r.toString(),u)];case 4:return a=t.sent().identity,h=new Date(1e3*a.expires_at),u=1e3*(a.expires_at-a.created_at),[4,Et().set("identityId",a.id,{expires:h,ttl:u})];case 5:return t.sent(),[2,a]}})}).then(function(t){e&&e(t),r.log("identity method ran successfully with",t)}).catch(st)},re.prototype.forget=function(){var t=this;this.log("forget method called"),Et().remove("identityId").then(function(){t.log("forget method ran successfully")}).catch(st)},re.prototype.event=function(r,t,i){var e,n,o=this;this.log("event batch method called for '"+r+"'"),"function"==typeof t?n=t:e=t,"orderCompletion"==r?this.order(t):this._events.constructRequest(r,e).then(function(t){o._batchEventCalls.push({request:t,onDone:function(t,e){if(t)return st(t);t=n||i;t&&e&&t(e),o.log("event '"+r+"' method ran successfully")}})}).catch(st)},re.prototype.whoami=function(e){var r=this;this.log("whoami method called"),this.getFetchInstance()(this.version+"/whoami").then(function(t){t=t.whoami;e&&e(t),r.log("whoami method ran successfully with",t)}).catch(st)},re.prototype.order=function(r){var i=this;this._events.constructRequest("orderCompletion",r).then(function(t){var e=i.getFetchInstance();r=t.params,e(i.version+"/orders/completions",{method:"POST",body:JSON.stringify({completion:r})}).catch(st)}).catch(st)},re.prototype.ping=function(e){var r=this;this.log("ping method called");function t(t){e&&e(t),r.log("ping method ran successfully with",t)}this.getFetchInstance()("ping").then(function(){t(!0)}).catch(function(){t(!1)})},re.prototype.debug=function(t){void 0===t&&(t=!0),this._isDebugEnabled=t},re.prototype.getFetchInstance=function(){if(!this._fetchInstance)throw new C(pt);return this._fetchInstance},re.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._isDebugEnabled&&console&&console.log&&console.log.apply(console,function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,n++)i[n]=o[s];return i}([bt],t))},re.prototype.updateStorageDriversOrder=function(t){Ct.createInstance(window,t)},re.prototype.updateBatchCallsConfiguration=function(t){this._batchEventCalls=new Pt(t,this)},re.prototype._testUtils=function(){},re.DEFAULT_BASE_URL="https://track.coherentpath.com",r([ut()],re.prototype,"init",null),r([ut()],re.prototype,"identity",null),r([ut()],re.prototype,"whoami",null),r([ut()],re.prototype,"ping",null),re);function re(){this._isDebugEnabled=!1,this.version="v1",this.currencyCode="USD",this._isInitialized=!1,this._events=new Bt(this),this._batchEventCalls=new Pt({},this),this._replayDelayedCalls()}function ie(n){return function(t,e,r,i){return n(t,e,f,i)}}ie(new Function);var ne=new ee;return Et().getDriver()||Object.getOwnPropertyNames(ee.prototype).filter(function(t){return"constructor"!==t}).forEach(function(t){ne[t]=function(){}}),ne}();
